# 브리지/스위치

## 소개
* 브리지와 스위치가 네트워크에 존재하는 호스트를 인지하고 호스트 사이의 패킷을 전달하는 방법을 구현한다.

## 목적
* 브리지와 스위치의 특성과 내부 작동 원리를 배운다.
* 브리지와 스위치가 네트워크 상의 호스트의 존재를 배우는 방법과 불필요한 네트워크 트래픽을 최소하하는 패킷 전달 방법을 배운다.
* LAN을 확장하는 VLAN의 정의와 특징을 배운다.

## 조건

### 브리지
* 진입 포트와 진입 패킷의 이더넷 헤더를 파싱한다.
* 원본 이더넷 주소와 진입 포트를 매핑하는 테이블을 유지한다.
  * 패킷의 대상 이더넷 주소가 테이블에 존재하는지 파악한다.
  * 존재하면 진입 패킷의 진입 포트와 일치하는 포트가 존재하는지 파악한다.
    * 존재할 경우 패킷을 버린다. 원본 호스트와 대상 호스트가 같은 세그먼트에 존재한다.
    * 존재하지 않을 경우 진입 포트를 제외한 모든 포트에 패킷을 브로드캐스트한다.
  * 존재하지 않으면 브로드캐스트한다.
  * 원본 이더넷 주소와 현재 패킷의 진입 포트를 매핑하는 테이블을 갱신한다.
  
### 스위치
* 진입 포트와 진입 패킷의 이더넷 헤더 (원본/대상 MAC 주소와 타입), VLAN 헤더 (존재할 경우)를 파싱한다.
* 패킷이 ARP 요청일 경우
  * 테이블을 새로운 원본 MAC 주소와 진입 포트로 갱신한다.
  * ARP 패킷을 브로드캐스트한다
    * 만약 VLAN 패킷일 경우 특정 VLAN에 속하는 호스트만 패킷을 받는다.
* 나머지 패킷의 경우
  * 이더넷 주소와 포트 매핑을 통해서 적절한 호스트에 전달한다.
  * 매핑이 없을 경우, 패킷을 버린다. 

## 기능
* 브리지의 경우 동일한 세그먼트에 존재하는 호스트의 패킷을 버려서 최적화
* 스위치의 경우 정확한 포트에만 패킷을 전달해서 브리지의 최적화를 향상

## 상태
* VLAN ID를 추출하는 방법에서 좌초